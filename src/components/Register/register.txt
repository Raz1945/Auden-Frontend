import React, { useState } from 'react';
import axios from 'axios';

import Cuenta from '../register2parte/crearcuenta';

const apiUrl = import.meta.env.VITE_API_BACKEND_URL;

function EmailInput() {
  const [email, setEmail] = useState('');
  const [mostrarCuenta, setMostrarCuenta] = useState(false);

  const handleEmailChange = (event) => {
    setEmail(event.target.value);
    console.log('Email cambiado:', event.target.value);
  };

  const handleContinuar = () => {
    // Realiza la solicitud POST con Axios
    axios.post(`${apiUrl}/register`, { email })
      .then((response) => {
        // Si la solicitud es exitosa, muestra el componente Cuenta
        setMostrarCuenta(true);
        console.log('Botón Continuar presionado. Email:', email);
      })
      .catch((error) => {
        // Maneja los errores de la solicitud
        console.error('Error al enviar el correo electrónico:', error);
      });
  };

  return (
    <div className="Main_box">
      {mostrarCuenta ? (
        <Cuenta email={email} />
      ) : (
        <>
          <div className='header'>
            <button className='btn_offborder btn_pages'>←</button>
            <p>Crear cuenta</p>
          </div>
          <p>¿Cuál es tu correo electrónico?</p>
          <label htmlFor="email">Correo electrónico:</label>
          <input
            type="email"
            id="email"
            name="email"
            value={email}
            onChange={handleEmailChange}
          />
          <button className="btn_orange btn btn_crearcuenta" onClick={handleContinuar}>
            Continuar
          </button>
        </>
      )}
    </div>
  );
}

export default EmailInput;